<!DOCTYPE html>
<html>
  <head>
    <title>jsPaint getting bootstrapped</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link href="css/bootstrap.min.css" rel="stylesheet" media="screen">

    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="js/jquery-2.0.3.min.js"></script>

    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="js/bootstrap.min.js"></script>

    <!-- Enable responsive features in IE8 with Respond.js (https://github.com/scottjehl/Respond)
    <script src="js/respond.js"></script> -->

    <!-- jsPaint -->
	<script type = "text/javascript" src = "js/point.js"></script>
	<script type = "text/javascript" src = "js/canvasHandler.js"> </script>
    <script type = "text/javascript" src = "js/admin.js"></script>
    <script type = "text/javascript" src = "js/tool.js"></script>
	<script type = "text/javascript" src = "js/tool_effects.js"></script>
	<script type = "text/javascript" src = "js/fileloader.js"></script>

    <link href="css/jsPaint.css" rel="stylesheet" media="screen">

  </head>
  <body>
    <div class="jsPaintContainer">
      <div class="row">
        <div class="col-lg-6 col-offset-3">
          <div class="panel panel-primary">
            <div class="panel-heading">
              <h3 class="panel-title">jsPaint</h3>
            </div>
            <div class="panel-body">
              <div class="btn-group">
                <button class="btn btn-info" onclick="makeNew();">new</button>
                <button class="btn btn-info" onclick="testDrawings();">test</button>
                <button class="btn btn-default" onclick="undoLast();" id="button_undo" disabled="1">undo</button>
				<button class="btn btn-default" onclick="loadFromDisk();" id="button_load">load</button>
              </div>
              <div class="btn-group">
                <button class="btn btn-success" onclick="useTool();">tool on</button>
                <button class="btn btn-danger" onclick="dontUseTool();">tool off</button>
              </div>
	          <div class="btn-group">
				<button class="btn btn-success" onclick="toolEffects.noise();">Noise</button>
				<button class="btn btn-success" onclick="toolEffects.contrast(-20);">Contrast -</button>
				<button class="btn btn-success" onclick="toolEffects.contrast(20);">Contrast +</button>
				<button class="btn btn-success" onclick="toolEffects.invert();">Invert</button>
				<button class="btn btn-success" onclick="toolEffects.grayscale();">Gray</button>
	          </div>
                <div id="aContainer"></div>
				<div id="statusPanel"></div>
            </div>
            <div class="panel-footer">
                <button onclick="saveIt();" class="btn btn-success">save</button>
                <button onclick="localStorage.clear();listArtInOutput();" class="btn btn-warning">clear</button>
              <div class="btn-group dropup">
                <button class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                  Storage <span class="caret"></span>
                </button>
                <ul class="dropdown-menu" id="storage-dropdown"></ul>
              </div>
              <div id="adminOutput"></div>
            </div>
          </div>
          <!-- textarea id="textarea_as_store" cols="50" rows="4" readonly="1" class="well"></textarea -->
        </div> <!-- //col-lg-6 col-offset-3 -->
      </div> <!-- //row -->
    </div> <!-- //container -->

    <!-- Hidden file selector to load images from local file system -->
    <input type="file" id="files" name="files[]"  style="visibility:hidden;position:absolute;top:-50;left:-50"/>

<!-- here comes the script! -->

  <script type="text/javascript">
    document.getElementById('adminOutput').innerHTML = listArtBtn();

    var myHandler = new CanvasHandler();
    myHandler.appendNewCanvas('aContainer', 'myCanvas', 200, 200);
    document.getElementById('adminOutput').innerHTML = listArtBtn();
    document.getElementById('storage-dropdown').innerHTML = listArtLi();

    var handlerPenTool;

    // one instance for tool effects (for later use).
    // (To-Do: hold instance later in application or provide via factory)
    var toolEffects = new ToolEffects(myHandler);

    function listArtInOutput ()
    {
      document.getElementById('adminOutput').innerHTML = listArtBtn();
      document.getElementById('storage-dropdown').innerHTML = listArtLi();
    }

	function useTool()
	{
		var tool = new Tool(myHandler);
		var content = myHandler.getContext('2d');

		handlerPenTool = function(event)
		{
			tool.draw(event, content);
		};

		document.getElementById('myCanvas').addEventListener( 'mousedown', handlerPenTool );
		document.getElementById('myCanvas').addEventListener( 'mousemove', handlerPenTool );
		document.getElementById('myCanvas').addEventListener( 'touchmove', handlerPenTool );
    }

	function dontUseTool()
	{
		document.getElementById('myCanvas').removeEventListener( 'mousedown', handlerPenTool );
		document.getElementById('myCanvas').removeEventListener( 'mousemove', handlerPenTool );
		document.getElementById('myCanvas').removeEventListener( 'touchmove', handlerPenTool );
	}

    /**
     * Trigger the hidden file selector
     * to start processing files from
     * local filesystem
     */
	function loadFromDisk()
	{
		document.getElementById('files').click();
	}

  </script>
  </body>

	<script type="text/javascript" src = "js/dragdrop.js"></script>

	<script type="text/javascript">
		// By the time when we have introduced
		// frameworks like jQuery, we can move this
		// code back top the top - included in document.ready()
		//
		// init Drag'n'Drop functionality
		var dragDrop = new DragDrop(myHandler);
		dragDrop.init('aContainer');

		// the fileLoader handles access to
		// the local filesystem to load images
		var fileLoader = new FileLoader(myHandler, 'files', false);
	</script>

</html>